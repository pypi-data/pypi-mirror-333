import{$ as te,a0 as ne,aL as E,aM as ue,a3 as oe,aN as ie,a4 as se,a5 as re,j as v,r as p,H as ce,a7 as de,a8 as fe,a9 as D,aO as me,z as a,aP as ve,ab as P,R as B,T as pe,aQ as ye,ar as Ve,aR as M,aS as Se,aT as he,d as ge,a as be,t as Ce,v as Ie,Z as V,A as f,B as b,aU as R,ac as ke,U as O,W as j}from"./Bl2PtCmi.js";import{u as we,b as Fe,a as xe,c as Ae,V as Pe,D as Be}from"./BMk0wala.js";import{S as Re}from"./DkCZQGJD.js";import{S as ze}from"./wHVUr-CK.js";import"./DlAUqK2U.js";import"./BCYVl_Vs.js";import"./BvH6OxSR.js";import"./D1jDBoMW.js";import"./BrqYU--B.js";import"./CvQdbTl1.js";const _e=te({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...ne({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>E(e).every(y=>y!=null&&typeof y=="object")},...ue({clearable:!0})},"VFileInput"),Ne=oe()({name:"VFileInput",inheritAttrs:!1,props:_e(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,y){let{attrs:C,emit:I,slots:t}=y;const{t:r}=ie(),n=se(e,"modelValue",e.modelValue,l=>E(l),l=>e.multiple||Array.isArray(e.modelValue)?l:l[0]??null),{isFocused:o,focus:F,blur:x}=re(e),k=v(()=>typeof e.showSize!="boolean"?e.showSize:void 0),m=v(()=>(n.value??[]).reduce((l,u)=>{let{size:S=0}=u;return l+S},0)),i=v(()=>M(m.value,k.value)),s=v(()=>(n.value??[]).map(l=>{const{name:u="",size:S=0}=l;return e.showSize?`${u} (${M(S,k.value)})`:u})),q=v(()=>{var u;const l=((u=n.value)==null?void 0:u.length)??0;return e.showSize?r(e.counterSizeString,l,i.value):r(e.counterString,l)}),z=p(),_=p(),c=p(),L=v(()=>o.value||e.active),N=v(()=>["plain","underlined"].includes(e.variant));function A(){var l;c.value!==document.activeElement&&((l=c.value)==null||l.focus()),o.value||F()}function H(l){var u;(u=c.value)==null||u.click()}function J(l){I("mousedown:control",l)}function Q(l){var u;(u=c.value)==null||u.click(),I("click:control",l)}function W(l){l.stopPropagation(),A(),Se(()=>{n.value=[],he(e["onClick:clear"],l)})}return ce(n,l=>{(!Array.isArray(l)||!l.length)&&c.value&&(c.value.value="")}),de(()=>{const l=!!(t.counter||e.counter),u=!!(l||t.details),[S,Z]=fe(C),{modelValue:Te,...G}=D.filterProps(e),K=me(e);return a(D,P({ref:z,modelValue:n.value,"onUpdate:modelValue":h=>n.value=h,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":N.value},e.class],style:e.style,"onClick:prepend":H},S,G,{centerAffix:!N.value,focused:o.value}),{...t,default:h=>{let{id:w,isDisabled:g,isDirty:T,isReadonly:U,isValid:X}=h;return a(ve,P({ref:_,"prepend-icon":e.prependIcon,onMousedown:J,onClick:Q,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},K,{id:w.value,active:L.value||T.value,dirty:T.value||e.dirty,disabled:g.value,focused:o.value,error:X.value===!1}),{...t,default:Y=>{var $;let{props:{class:ee,...le}}=Y;return a(B,null,[a("input",P({ref:c,type:"file",readonly:U.value,disabled:g.value,multiple:e.multiple,name:e.name,onClick:d=>{d.stopPropagation(),U.value&&d.preventDefault(),A()},onChange:d=>{if(!d.target)return;const ae=d.target;n.value=[...ae.files??[]]},onFocus:A,onBlur:x},le,Z),null),a("div",{class:ee},[!!(($=n.value)!=null&&$.length)&&!e.hideInput&&(t.selection?t.selection({fileNames:s.value,totalBytes:m.value,totalBytesReadable:i.value}):e.chips?s.value.map(d=>a(pe,{key:d,size:"small",text:d},null)):s.value.join(", "))])])}})},details:u?h=>{var w,g;return a(B,null,[(w=t.details)==null?void 0:w.call(t,h),l&&a(B,null,[a("span",null,null),a(ye,{active:!!((g=n.value)!=null&&g.length),value:q.value,disabled:e.disabled},t.counter)])])}:void 0})}),Ve({},z,_,c)}}),Je=ge({__name:"import",setup(e){const y=be(),C=we(),I=new Re(y.$axios),t=p(null),r=p(null),n=p(null),o=p(!1),F=[{text:"Scan",disabled:!0,exact:!0},{text:"Import",disabled:!0,to:"/scan/import",exact:!0}],x=()=>{t.value=null,r.value=null,n.value=null},k=async()=>{try{if(o.value=!0,t.value===void 0||t.value===null||n.value===void 0||n.value===null)return;await I.importScan(t.value,n.value,r.value),C.reportSuccess("Scan imported successfully.")}catch(m){C.reportError((m==null?void 0:m.message)||"An error was encountered while importing scan.")}finally{o.value=!1,x()}};return(m,i)=>(Ce(),Ie("div",null,[a(V(Be),{breadcrumbs:F,class:"mb-5"}),a(Pe,{variant:"outlined",class:"my-4",loading:V(o)},{default:f(()=>[a(Fe,{class:"font-weight-light"},{default:f(()=>[b(" Please fill in the required fields to import the scan: ")]),_:1}),a(xe,null,{default:f(()=>[a(ze,{"selected-scanner":V(t),"onUpdate:selectedScanner":i[0]||(i[0]=s=>R(t)?t.value=s:null),class:"mb-6"},null,8,["selected-scanner"]),a(Ne,{modelValue:V(n),"onUpdate:modelValue":i[1]||(i[1]=s=>R(n)?n.value=s:null),variant:"outlined","show-size":"",label:"File",placeholder:"Required JSON scan import file","prepend-icon":"mdi-file-upload-outline",density:"compact"},null,8,["modelValue"]),a(ke,{modelValue:V(r),"onUpdate:modelValue":i[2]||(i[2]=s=>R(r)?r.value=s:null),label:"Scan Id",placeholder:"Optional scan id to amend",clearable:"",variant:"outlined","prepend-icon":"mdi-format-text",density:"compact"},null,8,["modelValue"])]),_:1}),a(Ae,null,{default:f(()=>[a(O,{variant:"elevated",color:"success",loading:V(o),onClick:k},{default:f(()=>[a(j,{start:""},{default:f(()=>[b(" mdi-check ")]),_:1}),b("Import ")]),_:1},8,["loading"]),a(O,{variant:"elevated"},{default:f(()=>[a(j,{start:""},{default:f(()=>[b(" mdi-close ")]),_:1}),b("Cancel ")]),_:1})]),_:1})]),_:1},8,["loading"])]))}});export{Je as default};
