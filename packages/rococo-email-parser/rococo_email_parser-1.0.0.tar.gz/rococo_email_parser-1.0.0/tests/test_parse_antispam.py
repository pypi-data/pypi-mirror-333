import pytest
from rococo.parsers.email.header_parser import _parse_antispam_report_o365


def test_parse_o365_headers():
    category = _parse_antispam_report_o365("CIP:209.85.222.173;CTRY:US;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:mail-qk1-f173.google.com;PTR:mail-qk1-f173.google.com;CAT:NONE;SFS:(13230031)(230922051799003)(451199024)(109986022)(5660300002)(22186003)(42186006)(8676002)(1096003)(9686003)(336012)(26005)(6666004)(33964004)(58800400005)(86362001)(7596003)(356005)(55446002)(7636003)(564344004)(83380400001)(127190200002);DIR:INB;")
    assert category == None

    category = _parse_antispam_report_o365("CIP:209.85.216.45;CTRY:US;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:SPM;H:mail-pj1-f45.google.com;PTR:mail-pj1-f45.google.com;CAT:NONE;SFS:(13230031)(7916004)(84050400002)(230922051799003)(451199024)(1690799017)(31686004)(426003)(33964004)(73392003)(82202003)(44144004)(53546011)(9686003)(336012)(6666004)(26005)(86362001)(31696002)(7596003)(166002)(7636003)(356005)(1700899021)(33716001)(76482006)(83380400001)(15650500001)(5660300002)(1096003)(8676002)(6916009);DIR:INB;")
    assert category == "Spam"

    category = _parse_antispam_report_o365("CIP:209.85.216.45;CTRY:US;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:;H:mail-pj1-f45.google.com;PTR:mail-pj1-f45.google.com;CAT:SPM;SFS:(13230031)(7916004)(84050400002)(230922051799003)(451199024)(1690799017)(31686004)(426003)(33964004)(73392003)(82202003)(44144004)(53546011)(9686003)(336012)(6666004)(26005)(86362001)(31696002)(7596003)(166002)(7636003)(356005)(1700899021)(33716001)(76482006)(83380400001)(15650500001)(5660300002)(1096003)(8676002)(6916009);DIR:INB;")
    assert category == "Spam"
