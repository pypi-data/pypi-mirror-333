(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1500],{50697:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/integrations/[id]",function(){return n(31253)}])},67991:function(e,t,n){"use strict";n.d(t,{Od:function(){return o},QZ:function(){return a}});var i=n(27378);let a=e=>{let{items:t,selected:n,onChange:i}=e,a=t.every(e=>n.includes(e.id))&&!!t.length;return{allSelected:a,someSelected:t.some(e=>n.includes(e.id))&&!!t.length,handleToggleAll:()=>{a?i([]):i(t.map(e=>e.id))},handleToggleSelection:e=>{n.includes(e)?i(n.filter(t=>t!==e)):i([...n,e])}}},o=e=>{let{initialSelected:t,initialExcluded:n,initialAllSelected:a,itemCount:o}=e,[s,l]=(0,i.useState)(t),[r,c]=(0,i.useState)(n),[d,u]=(0,i.useState)(a||s.length===o),x=!!s.length||!!r.length;return{selected:s,excluded:r,allSelected:d,someSelected:x,handleToggleAll:()=>{d?(c([]),r.length||u(!1)):(l([]),u(!0))},handleToggleItemSelected:e=>{if(d)c(r.includes(e)?r.filter(t=>t!==e):[...r,e]);else{let t=s.includes(e)?s.filter(t=>t!==e):[...s,e];l(t),t.length===o&&u(!0)}}}}},79494:function(e,t,n){"use strict";var i=n(24246),a=n(56351);t.Z=e=>{let{title:t,icon:n,type:o,...s}=e;return(0,i.jsx)(a.wpx,{size:"small",type:o,"data-testid":"action-".concat(t),icon:n,iconPosition:"start",...s,children:t})}},31253:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return et}});var i=n(24246),a=n(56351),o=n(86677),s=n(7617),l=n(77213),r=n(77830),c=n(58754),d=n(94725),u=n(45216),x=n(38807),g=n(92222),m=n(59003),h=n(27378),p=n(18225);let j=(0,a.IUT)({displayName:"MonitorIcon",viewBox:"0 0 12 12",path:(0,i.jsx)("path",{d:"M1.33333 2.21875C1.15 2.21875 1 2.37344 1 2.5625V5.65625H3.66667C3.84167 5.65625 4.00417 5.75078 4.09583 5.90762L4.62708 6.8207L5.88542 4.22324C5.96667 4.05566 6.13125 3.94609 6.3125 3.93965C6.49375 3.9332 6.66667 4.02773 6.76042 4.18887L7.61458 5.65625H8.83333C9.11042 5.65625 9.33333 5.88613 9.33333 6.17188C9.33333 6.45762 9.11042 6.6875 8.83333 6.6875H7.33333C7.15833 6.6875 6.99583 6.59297 6.90417 6.43613L6.37292 5.52305L5.11458 8.12051C5.03333 8.28809 4.86875 8.39766 4.6875 8.4041C4.50625 8.41055 4.33333 8.31602 4.23958 8.15488L3.38542 6.6875H1V9.4375C1 9.62656 1.15 9.78125 1.33333 9.78125H10.6667C10.85 9.78125 11 9.62656 11 9.4375V2.5625C11 2.37344 10.85 2.21875 10.6667 2.21875H1.33333ZM0 2.5625C0 1.8041 0.597917 1.1875 1.33333 1.1875H10.6667C11.4021 1.1875 12 1.8041 12 2.5625V9.4375C12 10.1959 11.4021 10.8125 10.6667 10.8125H1.33333C0.597917 10.8125 0 10.1959 0 9.4375V2.5625Z",fill:"currentColor"})});var f=n(14481),b=n(72625),C=n(70675),y=n(812),v=e=>{let{defaultSuccessMsg:t,defaultErrorMsg:n}=e,i=(0,a.pmc)();return{toastResult:e=>{(0,y.D4)(e)?i({status:"error",description:(0,y.e$)(e.error,n)}):i({status:"success",description:t})}}},_=n(8133),k=n(46628),w=n(67991),S=n(91613);let R=(0,g.Cl)();var M=e=>{let{items:t,totalItemCount:n,selected:o,excluded:s,allSelected:l,someSelected:r,moreLoading:c,handleToggleSelection:d,handleToggleAll:u,onMoreClick:x}=e,j=t.map(e=>({id:e,isSelected:o.includes(e),isExcluded:s.includes(e)})),b=(0,h.useMemo)(()=>[R.display({id:"select",cell:e=>{let{row:t}=e;return(0,i.jsx)(f.k,{isChecked:t.original.isSelected||l&&!t.original.isExcluded,onChange:()=>d(t.original.id),dataTestId:"".concat(t.original.id,"-checkbox")})},header:()=>(0,i.jsx)(f.k,{isChecked:l,isIndeterminate:r,onChange:u,dataTestId:"select-all-checkbox"}),size:1}),R.accessor(e=>e.id,{id:"id",cell:e=>(0,i.jsx)(f.G3,{value:e.getValue()}),header:e=>(0,i.jsx)(f.Rr,{value:"Scope",...e})})],[d,u,l,r]),C=(0,m.b7)({getCoreRowModel:(0,g.sC)(),getRowId:e=>e.id,manualPagination:!0,data:j,columns:b,columnResizeMode:"onChange"});return(0,i.jsx)(a.kCb,{w:"full",direction:"column",maxH:"lg",children:(0,i.jsx)(f.ZK,{tableInstance:C,onRowClick:e=>d(e.id),footer:!!x&&(0,i.jsx)(f.vr,{totalColumns:2,children:(0,i.jsx)(a.kCb,{justify:"center",children:c?(0,i.jsx)(p.Z,{size:"xs"}):(0,i.jsxs)(a.kCb,{align:"center",children:[(0,i.jsxs)(a.xvT,{fontSize:"xs",mr:4,children:["Showing ",t.length," of ",n]}),(0,i.jsx)(a.wpx,{onClick:x,size:"small","data-testid":"load-more-btn",children:"Load more..."})]})})})})})};let T={items:[],total:1,page:1,size:50,pages:0};var A=(e,t)=>{let[n,i]=(0,h.useState)(2),{data:a,isLoading:o}=(0,C.oN)({page:1,size:25,connection_config_key:e}),s=(0,h.useRef)(o),{items:l,total:r}=null!=a?a:T,c=!!(null==a?void 0:a.pages)&&n>a.pages,[d,u]=(0,h.useState)(l);(0,h.useEffect)(()=>{s.current=o,u(l)},[o,l]),(0,h.useEffect)(()=>{let e=setTimeout(()=>{s.current&&t&&t()},5e3);return()=>clearTimeout(e)},[]);let[x,{isLoading:g,isFetching:m}]=(0,C.j3)(),p=g||m||o,j=async()=>{var t,a;if(c)return;let o=await x({connection_config_key:e,size:25,page:n+1});o.isError||(i(n+1),u([...d,...null!==(a=null===(t=o.data)||void 0===t?void 0:t.items)&&void 0!==a?a:[]]))};return{databases:d,totalDatabases:r,fetchMore:j,initialIsLoading:o,isLoading:p,reachedEnd:c}},E=e=>{var t;let{monitor:n,isEditing:o,isSubmitting:s,integrationKey:l,onSubmit:r,onClose:c}=e,d=(0,a.pmc)(),{databases:u,totalDatabases:x,fetchMore:g,reachedEnd:m,isLoading:h,initialIsLoading:j}=A(l,()=>{r({...n,databases:[]}),d({...k.MA,status:"info",description:"Loading resources is taking longer than expected. The monitor has been saved and is tracking all available resources. You can return later to limit its scope if needed"}),c()}),f=null!==(t=null==n?void 0:n.databases)&&void 0!==t?t:[],{selected:b,excluded:C,allSelected:y,someSelected:v,handleToggleItemSelected:_,handleToggleAll:R}=(0,w.Od)({initialSelected:f,initialExcluded:[],initialAllSelected:o&&!f.length,itemCount:x}),T=!y&&0===b.length;return j?(0,i.jsx)(p.Z,{my:12}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.kCb,{p:4,direction:"column",children:[(0,i.jsxs)(a.kCb,{direction:"row",mb:4,gap:1,align:"center",children:[(0,i.jsx)(a.xvT,{fontSize:"sm",children:"Select projects to monitor"}),(0,i.jsx)(S.Z,{label:"Selecting a project will monitor all current and future datasets within that project."})]}),(0,i.jsx)(M,{items:u,totalItemCount:x,selected:b,excluded:C,allSelected:y,someSelected:v,moreLoading:h,handleToggleSelection:_,handleToggleAll:R,onMoreClick:m?void 0:g})]}),(0,i.jsxs)("div",{className:"mt-4 flex w-full justify-between",children:[(0,i.jsx)(a.wpx,{onClick:c,children:"Cancel"}),(0,i.jsx)(a.ua7,{label:"Select one or more projects to save",isDisabled:!T,children:(0,i.jsx)(a.wpx,{onClick:()=>{r({...n,excluded_databases:C,databases:y?[]:b})},loading:s,type:"primary","data-testid":"save-btn",disabled:T,children:"Save"})})]})]})},Z=n(19508),N=n(96063),D=n(34090),L=n(59389),z=n(97181),O=n(40324),q=n(21702),I=e=>{var t,n;let{monitor:s,integrationOption:l,isSubmitting:r,databasesAvailable:c,onClose:d,onAdvance:u,onSubmit:x}=e,g=!!s,{query:m}=(0,o.useRouter)(),h=Array.isArray(m.id)?m.id[0]:m.id,p=L.Ry().shape({name:L.Z_().required().label("Name"),execution_frequency:L.Z_().nullable().label("Execution frequency"),execution_start_date:L.hT().nullable().label("Execution start date")}),j=(null==s?void 0:s.execution_start_date)?(0,Z.D)(s.execution_start_date):Date.now(),f={name:null!==(t=null==s?void 0:s.name)&&void 0!==t?t:"",execution_start_date:(0,N.WU)(j,"yyyy-MM-dd'T'HH:mm"),execution_frequency:null!==(n=null==s?void 0:s.execution_frequency)&&void 0!==n?n:q.hV.MONTHLY},b=(0,y.MM)(q.hV);return(0,i.jsx)(D.J9,{initialValues:f,enableReinitialize:!0,onSubmit:e=>{let t=e.execution_frequency!==q.hV.NOT_SCHEDULED?{execution_frequency:e.execution_frequency,execution_start_date:new Date(e.execution_start_date).toISOString()}:{execution_frequency:q.hV.NOT_SCHEDULED,execution_start_date:void 0},n=g?{...s,...t,name:e.name}:{...t,name:e.name,connection_config_key:h,classify_params:{num_samples:25,num_threads:1}};l.identifier===q.Rj.DYNAMODB&&(n.datasource_params={single_dataset:!1}),c?u(n):x(n)},validationSchema:p,children:e=>{let{values:t,isValid:n,resetForm:o}=e;return(0,i.jsx)(D.l0,{children:(0,i.jsxs)(a.gCW,{alignItems:"start",spacing:6,mt:4,children:[(0,i.jsx)(O.j0,{name:"name",id:"name",label:"Name",isRequired:!0,variant:"stacked"}),(0,i.jsx)(z.d,{name:"execution_frequency",id:"execution_frequency",tooltip:"Interval to run the monitor automatically after the start date",options:b,label:"Automatic execution frequency",layout:"stacked"}),(0,i.jsx)(O.YL,{name:"execution_start_date",label:"Automatic execution start time",disabled:t.execution_frequency===q.hV.NOT_SCHEDULED,id:"execution_start_date"}),(0,i.jsxs)("div",{className:"flex w-full justify-between",children:[(0,i.jsx)(a.wpx,{onClick:()=>{o(),d()},children:"Cancel"}),(0,i.jsx)(a.wpx,{htmlType:"submit",type:"primary",disabled:!n,loading:r,"data-testid":"next-btn",children:c?"Next":"Save"})]})]})})}})},V=n(31883),H=e=>{let{isOpen:t,onClose:n,formStep:o,onAdvance:s,monitor:l,isEditing:r,integration:c,integrationOption:d}=e,[u,{isLoading:x}]=(0,C.Fy)(),{data:g}=(0,C.oN)({page:1,size:25,connection_config_key:c.key}),m=!!g&&!!g.total,h=(0,a.pmc)(),{toastResult:j}=v({defaultSuccessMsg:"Monitor ".concat(r?"updated":"created"," successfully"),defaultErrorMsg:"A problem occurred while ".concat(r?"updating":"creating"," this monitor")}),f=async e=>{let t;let i=setTimeout(()=>{t||(h({...k.MA,status:"info",description:"Saving this monitor is taking longer than expected. Fides will continue processing it in the background, and you can check back later to view the updates."}),n())},5e3);(t=await u(e))&&(clearTimeout(i),j(t),(0,V.D4)(t)||n())};return(0,i.jsxs)(_.Z,{title:(null==l?void 0:l.name)?"Configure ".concat(l.name):"Configure discovery monitor",isOpen:t,onClose:n,children:[0===o&&(0,i.jsx)(I,{monitor:l,onClose:n,onAdvance:s,onSubmit:f,isSubmitting:x,databasesAvailable:m,integrationOption:d}),1===o&&(l?(0,i.jsx)(E,{monitor:l,isEditing:r,isSubmitting:x,onSubmit:f,onClose:n,integrationKey:c.key}):(0,i.jsx)(p.Z,{}))]})},P=n(58452),Y=n(79494),W=e=>{let{monitorId:t,onEditClick:n}=e,[o]=(0,C.Sb)(),{toastResult:s}=v({defaultErrorMsg:"A problem occurred deleting this monitor",defaultSuccessMsg:"Monitor deleted successfully"}),[l,{isLoading:r}]=(0,C.V9)(),{toastResult:c}=v({defaultErrorMsg:"A problem occurred initiating monitor execution",defaultSuccessMsg:"Monitor execution successfully started"}),d=async()=>{s(await o({monitor_config_id:t}))},{isOpen:u,onOpen:x,onClose:g}=(0,a.qY0)(),m=async()=>{c(await l({monitor_config_id:t}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.Z,{isOpen:u,onClose:g,onConfirm:d,title:"Delete monitor",message:"Are you sure you want to delete this discovery monitor?",continueButtonText:"Delete",isCentered:!0}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(a.ua7,{label:"Edit",children:(0,i.jsx)(a.wpx,{onClick:n,size:"small",icon:(0,i.jsx)(a.dY8,{}),"data-testid":"edit-monitor-btn","aria-label":"Edit monitor"})}),(0,i.jsx)(a.ua7,{label:"Delete",children:(0,i.jsx)(a.wpx,{onClick:x,size:"small",icon:(0,i.jsx)(a.pJl,{}),"aria-label":"Delete monitor","data-testid":"delete-monitor-btn"})}),(0,i.jsx)(Y.Z,{onClick:m,title:"Scan",loading:r})]})]})};let F=e=>{let{row:t,getValue:n}=e,[a]=(0,C.Fy)(),o=async e=>a({...t.original,enabled:e}),s=n();return(0,i.jsx)(b.S1,{enabled:s,onToggle:o,title:"Disabling monitor",message:"You are about to disable this monitor. If you continue, it will no longer scan automatically."})},G={items:[],total:0,page:1,size:50,pages:0},K=(0,g.Cl)(),U=e=>{let{onAddClick:t}=e;return(0,i.jsx)(a.gCW,{mt:6,p:10,spacing:4,borderRadius:"base",maxW:"70%","data-testid":"no-results-notice",alignSelf:"center",margin:"auto",children:(0,i.jsxs)(a.gCW,{children:[(0,i.jsx)(a.xvT,{fontSize:"md",fontWeight:"600",children:"No monitors"}),(0,i.jsx)(a.xvT,{fontSize:"sm",children:'You have not configured any data discovery monitors. Click "Add monitor" to configure data discovery now.'}),(0,i.jsx)(a.wpx,{onClick:t,type:"primary",children:"Add monitor"})]})})};var B=e=>{let{integration:t,integrationOption:n}=e,{PAGE_SIZES:o,pageSize:s,setPageSize:l,onPreviousPageClick:r,isPreviousPageDisabled:c,onNextPageClick:d,isNextPageDisabled:u,startRange:x,endRange:y,pageIndex:v,setTotalPages:_}=(0,f.oi)(),{isLoading:k,isFetching:w,data:S}=(0,C.Fu)({page:v,size:s,connection_config_key:t.key}),R=(0,a.qY0)(),[M,T]=(0,h.useState)(void 0),[A,E]=(0,h.useState)(!1),[Z,N]=(0,h.useState)(0),D=e=>{T(e),E(!0),R.onOpen()},L=null!=S?S:G,{items:z,total:O,pages:q}=(0,h.useMemo)(()=>L,[L]);(0,h.useEffect)(()=>{_(q)},[q,_]);let I=(0,h.useMemo)(()=>[K.accessor(e=>e.name,{id:"name",cell:e=>(0,i.jsx)(f.G3,{value:e.getValue()}),header:e=>(0,i.jsx)(f.Rr,{value:"Name",...e})}),K.accessor(e=>e.databases,{id:"projects",cell:e=>0===e.getValue().length?(0,i.jsx)(f.G3,{value:"All projects"}):(0,i.jsx)(f.WP,{suffix:"Projects",value:e.getValue(),...e,cellState:{isExpanded:!0}}),header:e=>(0,i.jsx)(f.Rr,{value:"Scope",...e})}),K.accessor(e=>e.execution_frequency,{id:"frequency",cell:e=>{var t;return(0,i.jsx)(f.G3,{value:null!==(t=e.getValue())&&void 0!==t?t:"Not scheduled"})},header:e=>(0,i.jsx)(f.Rr,{value:"Scan frequency",...e})}),K.accessor(e=>e.last_monitored,{id:"last_monitored",cell:e=>(0,i.jsx)(b.Cy,{time:e.getValue()}),header:e=>(0,i.jsx)(f.Rr,{value:"Last scan",...e})}),K.accessor(e=>e.enabled,{id:"status",cell:F,header:e=>(0,i.jsx)(f.Rr,{value:"Status",...e}),size:0,meta:{disableRowClick:!0}}),K.display({id:"action",cell:e=>(0,i.jsx)(W,{onEditClick:()=>D(e.row.original),monitorId:e.row.original.key}),header:"Actions",meta:{disableRowClick:!0}})],[]),V=(0,m.b7)({getCoreRowModel:(0,g.sC)(),getGroupedRowModel:(0,g.qe)(),getExpandedRowModel:(0,g.rV)(),getRowId:e=>e.name,manualPagination:!0,data:z,columns:I,columnResizeMode:"onChange"});return k?(0,i.jsx)(p.Z,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.xvT,{maxW:"720px",mb:6,fontSize:"sm",children:"A data discovery monitor observes configured systems for data model changes to proactively discover and classify data risks. Monitors can observe part or all of a project, dataset, table, or API for changes and each can be assigned to a different data steward."}),(0,i.jsxs)(f.Q$,{children:[(0,i.jsx)(a.LZC,{}),(0,i.jsx)(a.wpx,{onClick:R.onOpen,icon:(0,i.jsx)(j,{}),iconPosition:"end","data-testid":"add-monitor-btn",children:"Add monitor"}),(0,i.jsx)(H,{isOpen:R.isOpen,onClose:()=>{T(void 0),E(!1),N(0),R.onClose()},formStep:Z,onAdvance:e=>{T(e),N(1)},monitor:M,isEditing:A,integration:t,integrationOption:n})]}),(0,i.jsx)(f.ZK,{tableInstance:V,onRowClick:D,emptyTableNotice:(0,i.jsx)(U,{onAddClick:R.onOpen})}),(0,i.jsx)(f.s8,{totalRows:O||0,pageSizes:o,setPageSize:l,onPreviousPageClick:r,isPreviousPageDisabled:c||w,onNextPageClick:d,isNextPageDisabled:u||w,startRange:x,endRange:y})]})},$=n(15987),J=n(64176),Q=e=>{let{isOpen:t,onClose:n,connection:a}=e,o=(0,J.Z)(a.connection_type);return(0,i.jsx)(_.Z,{title:"Manage integration secret",isOpen:t,onClose:n,children:(0,i.jsx)($.Z,{connection:a,connectionOption:o,onCancel:n})})},X=n(41553),ee=n(75595),et=()=>{var e,t;let{query:n}=(0,o.useRouter)(),g=Array.isArray(n.id)?n.id[0]:n.id,{data:m,isLoading:h}=(0,d.jA)(null!=g?g:""),p=(0,J.Z)(null==m?void 0:m.connection_type),{testConnection:j,isLoading:f,testData:b}=(0,u.Z)(m),{onOpen:C,isOpen:y,onClose:v}=(0,a.qY0)(),{overview:_,instructions:k}=(0,x.ZP)(null==m?void 0:m.connection_type),w=(0,o.useRouter)();m&&!x.jq.includes(m.connection_type)&&w.push(r.KH);let S=[{label:"Connection",content:(0,i.jsxs)(a.xuv,{maxW:"720px",children:[(0,i.jsxs)(a.kCb,{borderRadius:"md",outline:"1px solid",outlineColor:"gray.100",align:"center",p:3,children:[(0,i.jsx)(a.kCb,{flexDirection:"column",children:(0,i.jsx)(X.Z,{testData:b})}),(0,i.jsx)(a.LZC,{}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)(a.wpx,{onClick:j,loading:f,"data-testid":"test-connection-btn",children:"Test connection"}),(0,i.jsx)(a.wpx,{onClick:C,"data-testid":"manage-btn",children:"Manage"})]})]}),(0,i.jsx)(Q,{isOpen:y,onClose:v,connection:m}),_,k]})},{label:"Data discovery",content:(0,i.jsx)(B,{integration:m,integrationOption:p})}];return(0,i.jsx)(l.Z,{title:"Integrations",children:(0,i.jsxs)(c.Z,{heading:"Integrations",breadcrumbItems:[{title:"All integrations",href:r.KH},{title:null!==(t=null!==(e=null==m?void 0:m.name)&&void 0!==e?e:null==m?void 0:m.key)&&void 0!==t?t:""}],children:[(0,i.jsx)(ee.Z,{integration:m,showDeleteButton:!0}),h?(0,i.jsx)(a.$jN,{}):!!m&&(0,i.jsx)(s.Z,{data:S,isLazy:!0})]})})}}},function(e){e.O(0,[8033,2780,2858,2866,9278,9255,4481,2201,7495,2888,9774,179],function(){return e(e.s=50697)}),_N_E=e.O()}]);