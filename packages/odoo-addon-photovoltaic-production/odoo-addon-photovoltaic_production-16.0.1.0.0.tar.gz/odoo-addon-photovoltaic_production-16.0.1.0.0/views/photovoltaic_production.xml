<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <menuitem
    id="photovoltaic_production_menu"
    name="Photovoltaic Production"
    sequence="10"
    web_icon="photovoltaic_production,static/description/icon.png"
  />

  <record id="photovoltaic_production_view_tree" model="ir.ui.view">
    <field name="name">photovoltaic_production.tree</field>
    <field name="model">photovoltaic.production</field>
    <field name="arch" type="xml">
      <tree default_order="date">
        <field name="date" />
        <field name="plant" />

        <field name="EAct_exp" />
        <field name="EAct_imp" />
        <field name="ERInd_exp" />
        <field name="ERInd_imp" />
      </tree>
    </field>
  </record>

  <record id="photovoltaic_production_view_search" model="ir.ui.view">
    <field name="name">photovoltaic_production.search</field>
    <field name="model">photovoltaic.production</field>
    <field name="arch" type="xml">
      <search>
        <field name="plant" />

        <filter
          string="Yesterday"
          name="filter_yesterday"
          domain="[ ( 'date', '&gt;=', (datetime.datetime.now() - datetime.timedelta(days=1)).strftime('%Y-%m-%d 00:00:00') ), ( 'date', '&lt;=', (datetime.datetime.now() - datetime.timedelta(days=1)).strftime('%Y-%m-%d 23:23:59') ) ]"
        />

        <filter
          string="2023"
          name="filter_2023"
          domain="[('date', '&gt;=', '2023-01-01'), ('date', '&lt;=', '2023-12-31')]"
        />

        <group name="groupby">
          <filter
            string="Plant"
            name="group_plant"
            domain=""
            context="{'group_by': 'plant'}"
          />

          <filter
            string="Month"
            name="group_month"
            domain=""
            context="{'group_by': 'date:month'}"
          />

          <filter
            string="Day"
            name="group_day"
            domain=""
            context="{'group_by': 'date:day'}"
          />
        </group>
      </search>
    </field>
  </record>

  <record id="photovoltaic_production_view_form" model="ir.ui.view">
    <field name="name">photovoltaic_production_form</field>
    <field name="model">photovoltaic.production</field>
    <field name="arch" type="xml">
      <form>
        <group colspan="4">
          <field name="date" />
          <field name="plant" />

          <field name="EAct_exp" />
          <field name="EAct_imp" />
          <field name="ERInd_imp" />
          <field name="ERInd_exp" />
        </group>
      </form>
    </field>
  </record>

  <record id="photovoltaic_production_action" model="ir.actions.act_window">
    <field name="name">Production</field>
    <field name="res_model">photovoltaic.production</field>
    <field name="view_mode">tree,form</field>
    <field name="context">{ 'search_default_group_plant': True, 'search_default_group_month': True, 'search_default_group_day': True }</field>
  </record>

  <record id="menu_photovoltaic_production" model="ir.ui.menu">
    <field name="name">Production</field>
    <field name="sequence" eval="70"/>
    <field name="action" ref="photovoltaic_production_action"/>
    <field name="parent_id" ref="photovoltaic_production_menu"/>
  </record>

  <record id="export_csv_act_window" model="ir.actions.act_window">
    <field name="name">Export CSV</field>
    <field name="res_model">export.csv.wizard</field>
    <field name="view_mode">form</field>
    <field name="target">new</field>
    <field name="view_id" ref="photovoltaic_production.export_csv_wizard_view_form"/>
    <field name="binding_model_id" ref="photovoltaic_production.model_photovoltaic_production"/>
    <field name="binding_view_types">list</field>
  </record>

  <record id="menu_export_csv" model="ir.ui.menu">
    <field name="name">Export CSV</field>
    <field name="sequence" eval="110"/>
    <field name="action" ref="export_csv_act_window"/>
    <field name="parent_id" ref="photovoltaic_production_menu"/>
  </record>

</odoo>
