Metadata-Version: 2.2
Name: login-canaime
Version: 1.2.0
Summary: Sistema de login Canaim√© para gerenciamento de unidades prisionais.
Home-page: https://github.com/A-Assuncao/login-canaime_project
Author: Anderson Assun√ß√£o
Author-email: andersongomesrr@hotmail.com
Keywords: login,canaime,browser automation,prison management
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Operating System :: OS Independent
Classifier: License :: OSI Approved :: MIT License
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.7
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: PySide6>=6.0.0
Requires-Dist: playwright>=1.30.0
Requires-Dist: qasync>=0.24.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Login Canaim√©

**Login Canaim√©** √© uma biblioteca Python que fornece uma interface gr√°fica moderna para realizar o login no Sistema Canaim√©, um sistema desenvolvido para gerenciar unidades prisionais e facilitar o controle de dados de reeducandos, dados administrativos, visitantes e acesso em tempo real a informa√ß√µes para √≥rg√£os como a Justi√ßa, Defensoria P√∫blica e Minist√©rio P√∫blico.

A biblioteca integra o **Model**, **View** e **Controller** para fornecer um fluxo de login robusto e reutiliz√°vel. Al√©m disso, ela utiliza o **PySide6** para a interface gr√°fica e o **Playwright** para automatizar o processo de login, permitindo a execu√ß√£o em modo headless (para produ√ß√£o) ou n√£o-headless (para testes).

## Instala√ß√£o

### Via pip

```bash
pip install login-canaime
```

Ap√≥s a instala√ß√£o, instale tamb√©m os navegadores necess√°rios para o Playwright:

```bash
playwright install
```

## Como usar

### Como Biblioteca em Seu C√≥digo

#### API S√≠ncrona (modo padr√£o)

```python
# M√©todo 1: Obter a p√°gina logada para automa√ß√£o
import asyncio
from loginCanaime import Login

# Obter a p√°gina j√° logada para automa√ß√£o com Playwright (m√©todo s√≠ncrono)
page = Login.get_page(test_mode=False)

# Agora voc√™ pode usar a p√°gina para navegar e automatizar tarefas
async def run_operations():
    if page:
        # Use a API ass√≠ncrona do Playwright
        await page.goto("https://canaime.com.br/sgp2rr/areas/unidades/alguma_pagina.php")
        # Realize suas opera√ß√µes...
    
    # Quando terminar, limpe os recursos
    Login.cleanup()

# Execute a fun√ß√£o ass√≠ncrona
asyncio.run(run_operations())
```

```python
# M√©todo 2: Apenas obter as credenciais (√∫til para desenvolvimento)
from loginCanaime import Login

credentials = Login.get_credentials(test_mode=False)
if credentials:
    print(f"Usu√°rio: {credentials['username']}")
    print(f"Senha: {credentials['password']}")

# Limpe os recursos quando terminar
Login.cleanup()
```

#### API Ass√≠ncrona (para uso em fun√ß√µes ass√≠ncronas)

```python
# M√©todo 1: Obter a p√°gina logada para automa√ß√£o (vers√£o ass√≠ncrona)
import asyncio
from loginCanaime import Login

async def run_login_and_operations():
    # Obter a p√°gina j√° logada usando a API ass√≠ncrona
    page = await Login.get_page_async(test_mode=False)
    
    if page:
        # Use a API ass√≠ncrona do Playwright
        await page.goto("https://canaime.com.br/sgp2rr/areas/unidades/alguma_pagina.php")
        # Realize suas opera√ß√µes...
    
    # Quando terminar, limpe os recursos
    Login.cleanup()

# Execute a fun√ß√£o ass√≠ncrona
asyncio.run(run_login_and_operations())
```

```python
# M√©todo 2: Obter credenciais de forma ass√≠ncrona
import asyncio
from loginCanaime import Login

async def get_user_credentials():
    credentials = await Login.get_credentials_async(test_mode=False)
    if credentials:
        print(f"Usu√°rio: {credentials['username']}")
        print(f"Senha: {credentials['password']}")
    
    # Limpe os recursos quando terminar
    Login.cleanup()

# Execute a fun√ß√£o ass√≠ncrona
asyncio.run(get_user_credentials())
```

### Integra√ß√£o com Aplica√ß√µes Qt Existentes

O Login Canaim√© detecta automaticamente se j√° existe uma inst√¢ncia de QApplication em execu√ß√£o e a utiliza em vez de criar uma nova. Isso facilita a integra√ß√£o com aplica√ß√µes Qt existentes:

```python
from PySide6.QtWidgets import QApplication, QMainWindow
import sys
from loginCanaime import Login

# Crie sua aplica√ß√£o Qt
app = QApplication(sys.argv)
main_window = QMainWindow()
main_window.show()

# O Login Canaim√© usar√° a inst√¢ncia de QApplication existente
page = Login.get_page(test_mode=True)

# Continue com sua aplica√ß√£o
app.exec()
```

### Via Linha de Comando

Ap√≥s instalar o pacote, voc√™ pode us√°-lo diretamente da linha de comando:

```bash
# Login padr√£o, abre interface gr√°fica e retorna p√°gina logada
canaime-login

# Executar em modo de teste (navegador vis√≠vel)
canaime-login --test

# Apenas obter credenciais sem iniciar navegador
canaime-login --credentials-only

# Usar a API ass√≠ncrona (√∫til para scripts que dependem de asyncio)
canaime-login --async
```

## Caracter√≠sticas

 1. **Interface moderna e personaliz√°vel:**
	  - Janela sem borda e fundo transl√∫cido;
     - Campos de e-mail e senha (este √∫ltimo com caracteres ocultos);
     - √çcone personalizado (baixado a partir de uma URL);
     - Spinner de carregamento (GIF animado) durante o processo de login;
     - Janela arrast√°vel (mesmo sem borda);

 2. **Fluxo de login ass√≠ncrono:**  
	 - Utiliza o QThread (via subclassifica√ß√£o de QThread) para executar o processo de login sem travar a interface;
	 - Oferece APIs s√≠ncronas e ass√≠ncronas para diferentes contextos de uso;

 3. **Retorno do resultado:**  
	 - Retorna o objeto `Page` logado (do Playwright) para uso em aplica√ß√µes reais;
	 - Permite tamb√©m, em modo de desenvolvimento, obter as credenciais digitadas;

 4. **Integra√ß√£o com outros sistemas:**
	 - Detecta e utiliza inst√¢ncias existentes de QApplication;
	 - Tratamento adequado de erros e exce√ß√µes;
	 - Gerenciamento autom√°tico de recursos.

## Estrutura do Projeto

```markdown
üì¶ login-canaime_project/        # Diret√≥rio raiz do projeto
‚îú‚îÄ‚îÄ ‚öôÔ∏è setup.py                  # Configura√ß√£o para instala√ß√£o via pip
‚îú‚îÄ‚îÄ üìã requirements.txt          # Lista de depend√™ncias do projeto
‚îú‚îÄ‚îÄ üõ°Ô∏è LICENSE                   # Arquivo de licen√ßa do projeto
‚îú‚îÄ‚îÄ üìñ README.md                 # Documenta√ß√£o do projeto
‚îú‚îÄ‚îÄ üìù MANIFEST.in               # Controle de arquivos inclu√≠dos no pacote
‚îî‚îÄ‚îÄ üì¶ loginCanaime/             # Pacote principal
    ‚îú‚îÄ‚îÄ üìÑ __init__.py           # Inicializa o pacote e exp√µe a classe Login
    ‚îú‚îÄ‚îÄ üìÑ __main__.py           # Ponto de entrada do pacote loginCanaime
    ‚îú‚îÄ‚îÄ üìÑ model.py              # L√≥gica de neg√≥cio (Model, utilizando Playwright)
    ‚îú‚îÄ‚îÄ üìÑ view.py               # Interface gr√°fica (View, utilizando PySide6)
    ‚îú‚îÄ‚îÄ üìÑ controller.py         # Controle de fluxo (Controller, utilizando QThread)
    ‚îú‚îÄ‚îÄ üìÑ main.py               # Fun√ß√µes principais para login
    ‚îî‚îÄ‚îÄ üìÅ resources/            # Recursos est√°ticos (imagens, √≠cones)
   ```

## Funcionamento Interno

-   **Model:**  
    O m√≥dulo `model.py` utiliza o Playwright para abrir o navegador, navegar at√© a p√°gina de login e preencher os campos de usu√°rio e senha.  
    Ele utiliza uma heur√≠stica baseada no conte√∫do de um elemento espec√≠fico da p√°gina para confirmar o sucesso do login e retorna uma tupla `(True, full_name, page)` ou `(False, "", None)`.
    
-   **View:**  
    O m√≥dulo `view.py` implementa a interface gr√°fica com PySide6, contendo campos para e-mail e senha, bot√£o de login, label de status e um spinner de carregamento (GIF).  
    A interface √© configurada sem borda, com um √≠cone personalizado (baixado de uma URL) e permite arrastar a janela.
    
-   **Controller:**  
    O m√≥dulo `controller.py` conecta a View e o Model. Utiliza um QThread (via subclassifica√ß√£o de QThread na classe `LoginThread`) para executar o login de forma ass√≠ncrona, mantendo a interface responsiva.  
    O Controller finaliza o aplicativo automaticamente assim que o login √© conclu√≠do, retornando o objeto `Page` logado.
    

## Contribui√ß√£o

Contribui√ß√µes s√£o bem-vindas! Se voc√™ deseja melhorar o c√≥digo, adicione novas funcionalidades ou corrigir problemas, sinta-se √† vontade para abrir _issues_ ou enviar _pull requests_.



## Contato

Anderson Assun√ß√£o ‚Äì andersongomesrr@hotmail.com  
Projeto dispon√≠vel em: [https://github.com/A-Assuncao/login-canaime_project](https://github.com/A-Assuncao/login-canaime_project)

## Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICEN√áA](LICENSE) para mais detalhes.  
  
----------  
**Desenvolvido com ‚ô• e Python.**
